<!doctype html>
<html lang="ar" dir="rtl">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>سلة الطلب</title><link rel="stylesheet" href="/assets/css/style.css"></head>
<body>
  <header style="display:flex;align-items:center;justify-content:space-between;padding-bottom:12px">
    <div class="logo"><div class="mark">AD</div><div><div style="font-weight:800">AutoDZ Parts</div></div></div>
    <nav><a class="btn" href="/index.html">الرئيسية</a></nav>
  </header>
  <main style="max-width:900px;margin:0 auto">
    <div class="card">
      <h2>سلة الطلب</h2>
      <div id="cartList" class="muted"></div>
      <div style="margin-top:12px">
        <button onclick="checkout()" class="qbtn">اطلب عبر واتساب</button>
      </div>
    </div>
  </main>
  <script>
    async function renderCart(){
      const cart = JSON.parse(localStorage.getItem('cart')||'{}');
      const resp = await fetch('/data/products.json'); const products = await resp.json();
      const lines = [];
      for(const id of Object.keys(cart)){
        const p = products.find(x=>x.id===id);
        if(!p) continue;
        lines.push(p.name_ar + ' x ' + cart[id] + ' • ' + new Intl.NumberFormat('ar-DZ').format(p.price_dzd) + ' دج');
      }
      document.getElementById('cartList').textContent = lines.join('\n');
    }
    function checkout(){
      const text = document.getElementById('cartList').textContent || 'أريد طلب';
      window.open('https://wa.me/213XXXXXXXXX?text='+encodeURIComponent(text),'_blank');
    }
    renderCart();
  </script>
</body>
</html>
